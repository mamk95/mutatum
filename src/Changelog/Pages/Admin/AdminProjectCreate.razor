@page "/admin/project/new"
@attribute [Authorize]

@using Changelog.Data
@inject ProjectService _projectService
@inject NavigationManager NavigationManager


<h3>AdminCreateProject</h3>

<EditForm Model="project" OnValidSubmit="CreateProject">
    <div>
        <label for="name" class="form-label">Name</label>

        <InputText id="name" @bind-Value="project.Name" class="form-control" />
    </div>

    <div>
        <label for="desc" class="form-label">Description</label>

        <InputText id="desc" @bind-Value="project.Description" class="form-control" />
    </div>

    <div>
        <label for="sort" class="form-label">Sort order (sidebar)</label>

        <InputNumber id="sort" @bind-Value="project.SortOrder" class="form-control" />
    </div>

    <div>
        <label for="hidden" class="form-label">Hidden/disabled</label>

        <InputCheckbox id="desc" @bind-Value="project.Hidden" />
    </div>

    <DataAnnotationsValidator />

    <ValidationSummary />

    <button type="submit" class="btn btn-primary">Create</button>
</EditForm>

@code {
    private Project project { get; set; } = new Project();

    private void CreateProject()
    {
        _projectService.AddProject(project.Name, project.Description, project.Hidden);
        NavigationManager.NavigateTo("/admin/project", true);
    }
}
